<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="3.22" DotMatrixReport="True" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Default" ReportOptions.CreateDate="40575.6159100116" ReportOptions.Description.Text="" ReportOptions.LastChange="40600.4180483218" ScriptLanguage="PascalScript" ScriptText.Text="var&#13;&#10;  Bulan : array [0..12] of string;&#13;&#10;  Tahun, BulanKe : integer;&#13;&#10;  NamaBulan, txtGol  : String;&#13;&#10;  zeroVal   : Double;&#13;&#10;  strWHERE:string;&#13;&#10;  stemp:string;&#13;&#10;  baris:integer;&#13;&#10;procedure ReplaceStr(var Source: string; ToReplace, ReplaceWith: string);&#13;&#10;var&#13;&#10;  x : integer;&#13;&#10;&#13;&#10;begin&#13;&#10;  x := Pos(ToReplace, Source);&#13;&#10;  while x &#62; 0 do&#13;&#10;  begin&#13;&#10;    DeleteStr(Source, x, length(ToReplace));&#13;&#10;    Insert(ReplaceWith, Source, x);&#13;&#10;    x := Pos(ToReplace, Source);&#13;&#10;  end;&#13;&#10;end;&#13;&#10;&#13;&#10;function HasSubUnit(kode_skpd : string): boolean;&#13;&#10;var kd_skpd:string;&#13;&#10;begin&#13;&#10;  kd_skpd:=trim(kode_skpd);&#13;&#10;  if copy(kd_skpd,length(kd_skpd)-1,2)='00' then&#13;&#10;     kd_skpd:=copy(kd_skpd,0,length(kd_skpd)-2);&#13;&#10;&#13;&#10;  qrySub.Close;&#13;&#10;  ReplaceStr(qrySub.SQL.Text, '&#60;unitkd&#62;', kd_skpd);&#13;&#10;  qrySub.Open;&#13;&#10;  Result:= (&#60;qrySub.&#34;sub_x&#34;&#62; &#62; 1);&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;procedure DialogPage1OnShow(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  i : integer;&#13;&#10;begin&#13;&#10;  cbTahun.Items.Clear;&#13;&#10;  while not qryTA.Eof do&#13;&#10;  begin&#13;&#10;    cbTahun.Items.Add( &#60;qryTA.&#34;Tahun&#34;&#62; );&#13;&#10;    qryTA.Next;&#13;&#10;  end;&#13;&#10;  cbTahun.ItemIndex := 0;&#13;&#10;&#13;&#10;  cbBulan.Items.Clear;&#13;&#10;  for i := 1 to 12 do&#13;&#10;    cbBulan.Items.Add( Bulan[i] );&#13;&#10;  if MonthOf(Date)=12 then&#13;&#10;  cbBulan.ItemIndex := 0&#13;&#10;  else&#13;&#10;  cbBulan.ItemIndex := MonthOf(Date);&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Button1OnClick(Sender: TfrxComponent);&#13;&#10;var kd_skpd:string;&#13;&#10;begin&#13;&#10;  Tahun := strtoint( cbTahun.Text );&#13;&#10;&#13;&#10;  qryGaji.Close;&#13;&#10;  strWhere:='(year(g.aktif_tgl)='+cbTahun.Text +')';&#13;&#10;&#13;&#10;  stemp:='0'+intToStr(cbBulan.ItemIndex + 1);&#13;&#10;  stemp:=copy(stemp,length(stemp)-1,2);&#13;&#10;  strWhere:=strWhere+'AND (month(g.aktif_tgl)='+ stemp+')';&#13;&#10;&#13;&#10;  ReplaceStr(qryGaji.SQL.Text, '1=1', strWhere);&#13;&#10;&#13;&#10;  qryGaji.Open;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure MasterData1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  qryAdd.Close;&#13;&#10;  qryAdd.SQL.Text:= 'SELECT PEGAWAI.NIP, PEGAWAI.TMT_PEGAWAI, ' +&#13;&#10;               'PEGAWAI.MASAKERJA, tblGolongan.URAIAN, PEGAWAI.STS_PEGAWAIKD ' +&#13;&#10;               'FROM PEGAWAI INNER JOIN '+&#13;&#10;               'tblGolongan ON PEGAWAI.GOLONGANKD = tblGolongan.GOLONGANKD ' +&#13;&#10;               'WHERE PEGAWAI.NIP=''' + &#60;qryGaji.&#34;NIP&#34;&#62; + '''';&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;  Bulan[00] := '';&#13;&#10;  Bulan[01] := 'Januari';&#13;&#10;  Bulan[02] := 'Februari';&#13;&#10;  Bulan[03] := 'Maret';&#13;&#10;  Bulan[04] := 'April';&#13;&#10;  Bulan[05] := 'Mei';&#13;&#10;  Bulan[06] := 'Juni';&#13;&#10;  Bulan[07] := 'Juli';&#13;&#10;  Bulan[08] := 'Agustus';&#13;&#10;  Bulan[09] := 'September';&#13;&#10;  Bulan[10] := 'Oktober';&#13;&#10;  Bulan[11] := 'November';&#13;&#10;  Bulan[12] := 'Desember';&#13;&#10;&#13;&#10;  zeroVal := 0;&#13;&#10;&#13;&#10;end." PropData="044C65667403C80203546F70023808446174617365747301010C2800000020446174615365743D2271727947616A692220446174615365744E616D653D2271727947616A692200010C2400000020446174615365743D2271727954412220446174615365744E616D653D2271727954412200010C2800000020446174615365743D22717279534B50442220446174615365744E616D653D22717279534B50442200010C2E00000020446174615365743D22717279506572696F64652220446174615365744E616D653D22717279506572696F64652200010C2600000020446174615365743D227172794164642220446174615365744E616D653D227172794164642200010C2600000020446174615365743D227172795375622220446174615365744E616D653D227172795375622200010C2A00000020446174615365743D2271727954657275732220446174615365744E616D653D227172795465727573220000095661726961626C65730100055374796C650100">
  <TfrxDMPPage Name="Page1" PaperWidth="378.459755578075" PaperHeight="278.87065322937" PaperSize="256" LeftMargin="7.61999507875318" RightMargin="7.61999507875318" TopMargin="8.99582752352806" BottomMargin="8.99582752352806" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="" FontStyle="0">
    <TfrxADOQuery Name="qryGaji" UserName="qryGaji" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select&#13;&#10;  g.unitkd,&#13;&#10;  u.unitnm,&#13;&#10;  g.nama,&#13;&#10;  g.nip,&#13;&#10;  g.golongankd,&#13;&#10;  gg.uraian as uraian_gol,&#13;&#10;  g.sts_pegawaikd,&#13;&#10;  case when g.sts_pegawaikd='P' then 'PNS' else 'CPNS' end as sts_peg,&#13;&#10;  left(g.golongankd,len(g.golongankd)-2) as gol,&#13;&#10;  g.aktif_kd,&#13;&#10;  g.aktif_tgl,&#13;&#10;  g.tmt_pegawai,&#13;&#10;  g.masakerja,&#13;&#10;  g.tgl_lahir,&#13;&#10;  g.sts_kwn,&#13;&#10;  g.jml_si,&#13;&#10;  g.jml_anak,&#13;&#10;  g.gaji_pokok,&#13;&#10;  g.tunj_istri,&#13;&#10;  g.tunj_anak,&#13;&#10;  g.tunj_beras,&#13;&#10;  g.tunj_kerja,&#13;&#10;  g.tunj_jab_struktur,&#13;&#10;  g.tunj_jab_fungsi,&#13;&#10;  g.tunj_umum,&#13;&#10;  g.tunj_umum_tamb,&#13;&#10;  g.tunj_otsus,&#13;&#10;  g.tunj_dt,&#13;&#10;  g.tunj_askes,&#13;&#10;  g.tunj_penghasilan,&#13;&#10;  g.pph,&#13;&#10;  g.pot_iwp,&#13;&#10;  g.pot_sewa_rumah,&#13;&#10;  g.pot_taperum,&#13;&#10;  g.pot_pangan,&#13;&#10;  g.pot_korpri,&#13;&#10;  g.pot_gaji_lebih,&#13;&#10;  g.pot_hutang,&#13;&#10;  g.pembulatan,&#13;&#10;  jbt_strukturkd,&#13;&#10;&#13;&#10; (case when g.tunj_jab_struktur&#62;0 then g.tunj_jab_struktur + 1000000&#13;&#10;else (case when g.tunj_jab_fungsi&#62;0 then g.tunj_jab_fungsi else g.tunj_umum - 100000 end) end) as eselon, g.tmt_jabatan&#13;&#10;from PEGAWAI g inner join tblunit u on g.unitkd=u.unitkd&#13;&#10;left outer join tblgolongan gg on g.golongankd=gg.golongankd&#13;&#10;inner join tblsts_aktif a on g.aktif_kd=a.aktif_kd&#13;&#10;where a.isaktif=0 and 1=1 --strWhere&#13;&#10;order by&#13;&#10; g.unitkd asc,&#13;&#10; (case when left(g.golongankd,3)='III' then 2&#13;&#10;       when left(g.golongankd,2)='IV' then 1&#13;&#10;       when left(g.golongankd,2)='II' then 3&#13;&#10;       when left(g.golongankd,1)='I' then 4 end) asc, g.tunj_jab_struktur desc, g.tunj_jab_fungsi desc, g.tunj_umum desc, g.gaji_pokok desc,&#13;&#10;g.golongankd desc, g.MASAKERJA DESC, g.STS_PEGAWAIKD DESC, g.TMT_PEGAWAI ASC" CommandTimeout="30" PropData="0A506172616D65746572730100"/>
    <TfrxADOQuery Name="qryTA" UserName="qryTA" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select *&#13;&#10;from tblTahun&#13;&#10;order by tahun desc" CommandTimeout="30" PropData="0A506172616D65746572730100"/>
    <TfrxADOQuery Name="qrySKPD" UserName="qrySKPD" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select unitkd, unitnm&#13;&#10;from tblUnit&#13;&#10;WHERE unitkd=:unitkd" CommandTimeout="30" PropData="0A506172616D657465727301010C22000000204E616D653D22756E69746B64222044617461547970653D226674537472696E67220000"/>
    <TfrxADOQuery Name="qryPeriode" UserName="qryPeriode" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select * from pegawai_gaji_jenis&#13;&#10;where jenis=0" CommandTimeout="30" PropData="0A506172616D65746572730100"/>
    <TfrxADOQuery Name="qryAdd" UserName="qryAdd" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT PEGAWAI.NIP, PEGAWAI.TMT_PEGAWAI, PEGAWAI.MASAKERJA, tblGolongan.URAIAN, PEGAWAI.STS_PEGAWAIKD FROM PEGAWAI INNER JOIN tblGolongan ON PEGAWAI.GOLONGANKD = tblGolongan.GOLONGANKD WHERE PEGAWAI.NIP='480105296'" CommandTimeout="30" PropData="0A506172616D65746572730100"/>
    <TfrxADOQuery Name="qrySub" UserName="qrySub" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select count(unitkd) as sub_x&#13;&#10;from tblunit&#13;&#10;where unitkd like '&#60;unitkd&#62;%'" CommandTimeout="30" PropData="0A506172616D65746572730100"/>
    <TfrxADOQuery Name="qryTerus" UserName="qryTerus" CloseDataSource="True" FieldAliases.Text="" SQL.Text="" CommandTimeout="30" PropData="0A506172616D65746572730100"/>
    <TfrxMasterData Name="MasterData1" Height="102" Left="0" Top="289" Width="1372.8" OnBeforePrint="MasterData1OnBeforePrint" ColumnWidth="0" ColumnGap="0" DataSet="qryGaji" DataSetName="qryGaji" KeepTogether="True" RowCount="0" Stretched="True">
      <TfrxDMPMemoView Name="DMPMemo4" Left="57.6" Top="0" Width="316.8" Height="85" StretchMode="smActualHeight" DisplayFormat.DecimalSeparator="." Frame.Style="fsDot" Frame.Typ="9" WordWrap="False" Text="[qryGaji.&#34;nama&#34;]&#13;&#10;[qryGaji.&#34;nip&#34;] &#13;&#10;[qryGaji.&#34;sts_peg&#34;] /Tmt.[qryGaji.&#34;STS_PEGAWAIKD&#34;].[iif(yearof(&#60;qryGaji.&#34;TMT_PEGAWAI&#34;&#62;)&#60;=1900, '  -  -', formatdatetime('dd-mm-yyyy', &#60;qryGaji.&#34;TMT_PEGAWAI&#34;&#62;))]&#13;&#10;[&#60;qryGaji.&#34;golongankd&#34;&#62;] - [qryGaji.&#34;URAIAN_GOL&#34;]&#13;&#10;MKG :  [qryGaji.&#34;MASAKERJA&#34;]Thn, 00 Bln."/>
      <TfrxDMPMemoView Name="DMPMemo1" ShiftMode="smWhenOverlapped" Left="9.6" Top="0" Width="38.4" Height="85" StretchMode="smActualHeight" DisplayFormat.DecimalSeparator="." Frame.Style="fsDot" Frame.Typ="9" HAlign="haRight" WordWrap="False" Text="[Line#]"/>
      <TfrxDMPMemoView Name="DMPMemo12" ShiftMode="smWhenOverlapped" Left="230.4" Top="17" Width="124.8" Height="17" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="dd-mm-yyyy" DisplayFormat.Kind="fkDateTime" HAlign="haRight" WordWrap="False" Text="/[iif(yearof(&#60;qryGaji.&#34;tgl_lahir&#34;&#62;)&#60;=1900, '  -  -   ', formatdatetime('DD-MM-YYYY', &#60;qryGaji.&#34;tgl_lahir&#34;&#62;))]"/>
      <TfrxDMPMemoView Name="DMPMemo2" Left="384" Top="0" Width="297.6" Height="85" StretchMode="smActualHeight" DisplayFormat.DecimalSeparator="." Frame.Style="fsDot" Frame.Typ="9" WordWrap="False" Text="[qryGaji.&#34;nama&#34;]&#13;&#10;[qryGaji.&#34;nip&#34;] &#13;&#10;[qryGaji.&#34;sts_peg&#34;] /Tmt.[qryGaji.&#34;STS_PEGAWAIKD&#34;].[iif(yearof(&#60;qryGaji.&#34;TMT_PEGAWAI&#34;&#62;)&#60;=1900, '  -  -', formatdatetime('dd-mm-yyyy', &#60;qryGaji.&#34;TMT_PEGAWAI&#34;&#62;))]&#13;&#10;[&#60;qryGaji.&#34;golongankd&#34;&#62;] - [qryGaji.&#34;URAIAN_GOL&#34;]&#13;&#10;MKG :  [qryGaji.&#34;MASAKERJA&#34;]Thn, 00 Bln."/>
      <TfrxDMPMemoView Name="DMPMemo3" Left="710.4" Top="0" Width="825.6" Height="85" StretchMode="smActualHeight" DisplayFormat.DecimalSeparator="." Frame.Style="fsDot" Frame.Typ="9" WordWrap="False" Text="[qryGaji.&#34;nama&#34;]&#13;&#10;[qryGaji.&#34;nip&#34;] &#13;&#10;[qryGaji.&#34;sts_peg&#34;] /Tmt.[qryGaji.&#34;STS_PEGAWAIKD&#34;].[iif(yearof(&#60;qryGaji.&#34;TMT_PEGAWAI&#34;&#62;)&#60;=1900, '  -  -', formatdatetime('dd-mm-yyyy', &#60;qryGaji.&#34;TMT_PEGAWAI&#34;&#62;))]&#13;&#10;[&#60;qryGaji.&#34;golongankd&#34;&#62;] - [qryGaji.&#34;URAIAN_GOL&#34;]&#13;&#10;MKG :  [qryGaji.&#34;MASAKERJA&#34;]Thn, 00 Bln."/>
    </TfrxMasterData>
    <TfrxGroupHeader Name="GroupHeader2" Height="255" Left="0" Top="17" Width="1372.8" Condition="qryGaji.&#34;unitkd&#34;" ReprintOnNewPage="True" StartNewPage="True">
      <TfrxDMPMemoView Name="Memo17" Left="57.6" Top="221" Width="297.6" Height="17" DisplayFormat.DecimalSeparator="." Frame.Style="fsDot" Frame.Typ="15" HAlign="haCenter" VAlign="vaCenter" Text="2"/>
      <TfrxDMPMemoView Name="Memo8" Left="9.6" Top="85" Width="38.4" Height="34" Frame.Style="fsDot" Frame.Typ="7" HAlign="haCenter" VAlign="vaCenter" Text="NO.&#13;&#10;URUT"/>
      <TfrxDMPMemoView Name="Memo9" Left="57.6" Top="85" Width="124.8" Height="34" DisplayFormat.DecimalSeparator="." Frame.Style="fsDot" Frame.Typ="5" HAlign="haCenter" VAlign="vaCenter" Text="NAMA"/>
      <TfrxDMPMemoView Name="Memo14" Left="9.6" Top="221" Width="38.4" Height="17" DisplayFormat.DecimalSeparator="." Frame.Style="fsDot" Frame.Typ="15" HAlign="haCenter" VAlign="vaCenter" Text="1"/>
      <TfrxDMPMemoView Name="Memo123" Left="9.6" Top="51" Width="96" Height="17" Text="BULAN &#60;cbbulan.TEXT&#62; TAHUN &#60;cbTahun.Text&#62;"/>
      <TfrxDMPMemoView Name="DMPMemo11" Left="9.6" Top="17" Width="883.2" Height="17" DisplayFormat.DecimalSeparator="." HAlign="haCenter" Text="DAFTAR PEGAWAI PENSIUN"/>
      <TfrxDMPMemoView Name="DMPMemo19" Left="9.6" Top="0" Width="883.2" Height="17" DisplayFormat.DecimalSeparator="." HAlign="haCenter" Text="PEMERINTAH KABUPATEN PURBALINGGA"/>
      <TfrxDMPMemoView Name="DMPMemo5" Left="307.2" Top="85" Width="57.6" Height="34" FontStyle="0" ParentFont="False" VAlign="vaCenter" Text="STATUS PEG"/>
      <TfrxDMPMemoView Name="DMPMemo6" Left="182.4" Top="85" Width="124.8" Height="34" FontStyle="0" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="NIP"/>
      <TfrxDMPMemoView Name="DMPMemo7" Left="364.8" Top="85" Width="57.6" Height="34" FontStyle="0" ParentFont="False" VAlign="vaCenter" Text="GOL"/>
      <TfrxDMPMemoView Name="DMPMemo8" Left="422.4" Top="85" Width="57.6" Height="34" FontStyle="0" ParentFont="False" VAlign="vaCenter" Text="STATUS"/>
    </TfrxGroupHeader>
  </TfrxDMPPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" BorderStyle="bsDialog" Height="255" Left="308" Top="137" Width="398" OnShow="DialogPage1OnShow">
    <TfrxGroupBoxControl Name="gbJenisGaji" Left="10" Top="10" Width="368" Height="50" Caption="Jenis Gaji" Color="-16777201">
      <TfrxRadioButtonControl Name="rbGajiReguler" Left="4" Top="20" Width="117" Height="17" Caption="Gaji Induk (Standar)" Checked="True" Color="-16777201"/>
      <TfrxRadioButtonControl Name="rbGaji13" Left="136" Top="20" Width="73" Height="17" Caption="Gaji ke-13" Color="-16777201"/>
      <TfrxRadioButtonControl Name="rbGajiTerus" Left="232" Top="20" Width="89" Height="17" Caption="Gaji Terusan" Color="-16777201"/>
    </TfrxGroupBoxControl>
    <TfrxComboBoxControl Name="cbTahun" Left="106" Top="72" Width="100" Height="21" Color="-16777211" Items.Text="2010&#13;&#10;2009&#13;&#10;2008" Style="csDropDownList" Text="2010" ItemIndex="0"/>
    <TfrxComboBoxControl Name="cbBulan" Left="106" Top="96" Width="100" Height="21" Color="-16777211" Items.Text="Januari&#13;&#10;Februari&#13;&#10;Maret&#13;&#10;April&#13;&#10;Mei&#13;&#10;Juni&#13;&#10;Juli&#13;&#10;Agustus&#13;&#10;September&#13;&#10;Oktober&#13;&#10;November&#13;&#10;Desember" Style="csDropDownList" Text="April" ItemIndex="3"/>
    <TfrxLabelControl Name="Label1" Left="14" Top="76" Width="80" Height="13" Caption="Tahun Anggaran" Color="-16777201"/>
    <TfrxLabelControl Name="Label2" Left="14" Top="100" Width="26" Height="13" Caption="Bulan" Color="-16777201"/>
    <TfrxLabelControl Name="Label3" Left="98" Top="76" Width="4" Height="13" Caption=":" Color="-16777201"/>
    <TfrxLabelControl Name="Label4" Left="98" Top="100" Width="4" Height="13" Caption=":" Color="-16777201"/>
    <TfrxEditControl Name="edNamaNIP" Left="106" Top="120" Width="213" Height="21" Color="-16777211" MaxLength="0" PasswordChar="0"/>
    <TfrxCheckBoxControl Name="cbIncludeSub" Left="14" Top="156" Width="305" Height="17" Visible="False" Caption="Termasuk unit kerja dibawahnya" Color="-16777201"/>
    <TfrxLabelControl Name="Label7" Left="14" Top="128" Width="54" Height="13" Caption="Nama / NIP" Color="-16777201"/>
    <TfrxLabelControl Name="Label8" Left="98" Top="124" Width="4" Height="13" Caption=":" Color="-16777201"/>
    <TfrxButtonControl Name="btLanjut" Left="302" Top="184" Width="75" Height="25" Caption="&Lanjut" Default="True" ModalResult="1" OnClick="Button1OnClick"/>
    <TfrxButtonControl Name="btBatal" Left="222" Top="184" Width="75" Height="25" Cancel="True" Caption="&Batal" ModalResult="2"/>
    <TfrxCheckBoxControl Name="chkSKPD" Left="212" Top="76" Width="161" Height="17" Caption="Cetak Semua SKPD" Color="-16777201"/>
  </TfrxDialogPage>
</TfrxReport>
